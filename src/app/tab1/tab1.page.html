<ion-header>
  <ion-toolbar>
    <ion-title>Catalogo</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <div style="width: 30px; height: 30px;" (click)="openWhatsApp()">
    <img src="assets/icon/icons8-whatsapp-100.png" class="img-whatsapp" alt="Favicon">
  </div>

  <!-- Barra de búsqueda -->
  <div class="search-container">
    <ion-item class="search-item">
      <ion-label position="stacked">Buscar producto</ion-label>
      <ion-input 
        type="text" 
        [value]="searchTerm"
        (ionInput)="onSearchChange($event)"
        placeholder="Escribe el nombre del producto..."
        clearOnEdit="false">
      </ion-input>
      <ion-button 
        *ngIf="searchTerm" 
        (click)="clearSearch()" 
        fill="clear" 
        size="small"
        slot="end">
        <ion-icon slot="icon-only" name="close"></ion-icon>
      </ion-button>
    </ion-item>
  </div>

  <!-- Mensaje cuando no hay resultados de búsqueda -->
  <div *ngIf="products.length > 0 && filteredProducts.length === 0" class="empty-search-state">
    <p>No se encontraron productos que coincidan con "{{ searchTerm }}"</p>
    <ion-button (click)="clearSearch()" fill="outline" class="ion-margin-top">
      Limpiar búsqueda
    </ion-button>
  </div>

  <div class="products-container">
    <ion-card *ngFor="let product of filteredProducts" class="product-card" (click)="goToProductDetail(product.id)">
      
      <!-- Imagen del producto con badge HOT SALE -->
      <div class="product-image-container">
        <img draggable="false" [src]="product.image" [alt]="product.name" class="product-image" />
        <div class="hot-sale-badge" *ngIf="product.hotSale">
          Disponible
        </div>
      </div>

      <!-- Contenido de la tarjeta -->
      <div class="product-content">
        <!-- Categoría -->
        <div class="product-category">{{ product.category }}</div>
        
        <!-- Nombre del producto -->
        <h2 class="product-name">{{ product.name }}</h2>
        
        <!-- Descripción -->
        <p class="product-description">{{ product.description }}</p>
        
        <!-- Features/Tags -->
        <div class="product-features">
          <span class="feature-tag" *ngFor="let feature of product.features">
            {{ feature }}
          </span>
        </div>
        
        <!-- Precio y botón -->
        <div class="product-pricing-row">
          <div class="pricing-info">
            <!-- Precio original tachado -->
            <div class="original-price" *ngIf="product.originalPrice">
              ${{ product.originalPrice | number:'1.0-0' }}
            </div>
            <!-- Precio actual -->
            <div class="current-price">
              ${{ product.price | number:'1.0-0' }}
            </div>
          </div>
          
          <!-- Botón Compartir -->
          <button 
            class="share-btn" 
            (click)="shareProduct(product); $event.stopPropagation()"
            type="button">
            <i class="fas fa-share-alt"></i>
          </button>
        </div>
        
        <!-- Rating y Reviews -->
        <div class="product-rating-row">
          <div class="rating-section">
            <div class="stars">
              <i 
                *ngFor="let star of getStars(product.rating); let i = index" 
                [class.fas]="star === 'full'"
                [class.far]="star === 'empty'"
                class="fa-star star-icon"
                [attr.aria-label]="'Star ' + (i + 1)">
              </i>
            </div>
            <span class="reviews-count">{{ product.reviews }} Reviews</span>
          </div>
          
          <!-- Estado de stock -->
          <div class="stock-status" [class.in-stock]="product.inStock">
            {{ product.inStock ? 'In Stock' : 'Out of Stock' }}
          </div>
        </div>
      </div>

    </ion-card>
  </div>

</ion-content>
