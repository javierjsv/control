<ion-header class="custom-header">
  <div class="header-content-wrapper">
    <!-- Secci√≥n de t√≠tulo con icono de beb√© -->
    <div class="header-title-section">
      <div class="baby-icon-container">
        <div class="baby-icon">üë∂</div>
        <div class="heart-icon">‚ù§Ô∏è</div>
      </div>
      <div class="title-content">
        <h1 class="main-title">Todo para el cuidado de tu beb√©</h1>
        <p class="subtitle">Encuentra cremitas, pa√±ales y m√°s</p>
      </div>
    </div>
  </div>
</ion-header>

<ion-content class="ion-padding">
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content
      pullingIcon="arrow-down"
      pullingText="Arrastra para actualizar"
      refreshingSpinner="circles"
      refreshingText="Actualizando...">
    </ion-refresher-content>
  </ion-refresher>

  <!-- Header mejorado -->
  <div class="header-section">


    <!-- Barra de b√∫squeda mejorada -->
    <div class="search-container">
      <div class="search-bar">
        <ion-icon name="search" class="search-icon"></ion-icon>
        <ion-input 
          type="text" 
          [value]="searchTerm"
          (ionInput)="onSearchChange($event)"
          placeholder="Buscar cremas, pa√±ales, toallitas..."
          class="search-input">
        </ion-input>
        <ion-button 
          *ngIf="searchTerm" 
          (click)="clearSearch()" 
          fill="clear" 
          size="small"
          class="clear-button">
          <ion-icon slot="icon-only" name="close"></ion-icon>
        </ion-button>
      </div>
    </div>

    <!-- Filtros de categor√≠a -->
    <div class="category-filters">
      <button
        class="category-tag"
        *ngFor="let category of categories"
        [class.active]="selectedCategory === category.name"
        (click)="selectCategory(category.name)">
        <span class="category-icon">{{ category.icon }}</span>
        <span class="category-text">{{ category.name }}</span>
      </button>
    </div>
  </div>

  <div style="width: 30px; height: 30px;" (click)="openWhatsApp()">
    <img src="assets/icon/icons8-whatsapp-100.png" class="img-whatsapp" alt="Favicon">
  </div>

  <!-- Mensaje cuando no hay resultados de b√∫squeda -->
  <div *ngIf="products.length > 0 && filteredProducts.length === 0" class="empty-search-state">
    <p *ngIf="searchTerm">No se encontraron productos que coincidan con "{{ searchTerm }}"</p>
    <p *ngIf="selectedCategory && !searchTerm">No se encontraron productos en la categor√≠a "{{ selectedCategory }}"</p>
    <p *ngIf="selectedCategory && searchTerm">No se encontraron productos que coincidan con los filtros aplicados</p>
    <ion-button (click)="clearSearch()" fill="outline" class="ion-margin-top">
      Limpiar filtros
    </ion-button>
  </div>

  <div class="products-container">
    <ion-card *ngFor="let product of filteredProducts" class="product-card" (click)="goToProductDetail(product.id)">
      
      <!-- Imagen del producto con badge HOT SALE -->
      <div class="product-image-container">
        <img draggable="false" [src]="product.image" [alt]="product.name" class="product-image" />
        <div class="hot-sale-badge" *ngIf="product.hotSale">
          Disponible
        </div>
      </div>

      <!-- Contenido de la tarjeta -->
      <div class="product-content">
        <!-- Categor√≠a -->
        <div class="product-category">{{ product.category }}</div>
        
        <!-- Nombre del producto -->
        <h2 class="product-name">{{ product.name }}</h2>
        
        <!-- Descripci√≥n -->
        <p class="product-description">{{ truncateDescription(product.description) }}</p>
        
        <!-- Features/Tags -->
        <div class="product-features">
          <span class="feature-tag" *ngFor="let feature of product.features">
            {{ feature }}
          </span>
        </div>
        
        <!-- Precio y bot√≥n -->
        <div class="product-pricing-row">
          <div class="pricing-info">
            <!-- Precio original tachado -->
            <div class="original-price" *ngIf="product.originalPrice">
              ${{ product.originalPrice | number:'1.0-0' }}
            </div>
            <!-- Precio actual -->
            <div class="current-price">
              ${{ product.price | number:'1.0-0' }}
            </div>
          </div>
          
          <!-- Bot√≥n Compartir -->
          <button 
            class="share-btn" 
            (click)="shareProduct(product); $event.stopPropagation()"
            type="button">
            <i class="fas fa-share-alt"></i>
          </button>
        </div>
        
        <!-- Rating y Reviews -->
        <div class="product-rating-row">
          <div class="rating-section">
            <div class="stars">
              <i 
                *ngFor="let star of getStars(product.rating); let i = index" 
                [class.fas]="star === 'full'"
                [class.far]="star === 'empty'"
                class="fa-star star-icon"
                [attr.aria-label]="'Star ' + (i + 1)">
              </i>
            </div>
            <span class="reviews-count">{{ product.reviews }} Reviews</span>
          </div>
          
          <!-- Estado de stock -->
          <div class="stock-status" [class.in-stock]="product.inStock">
            {{ product.inStock ? 'In Stock' : 'Out of Stock' }}
          </div>
        </div>
      </div>

    </ion-card>
  </div>

  <!-- Infinite Scroll -->
  <ion-infinite-scroll 
    *ngIf="!searchTerm && !selectedCategory && hasMore"
    (ionInfinite)="loadMoreProducts($event)"
    threshold="100px">
    <ion-infinite-scroll-content
      loadingSpinner="bubbles"
      loadingText="Cargando m√°s productos...">
    </ion-infinite-scroll-content>
  </ion-infinite-scroll>

</ion-content>
